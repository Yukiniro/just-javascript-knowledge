import { normalizeImagePath } from 'rspress/runtime';

# JavaScript 宇宙

一开始是值

值是什么？这很难说。

几何中的点是什么？人类语言中的单词是什么？值是 JavaScript 中的一个基本概念 -- 所以我们不能通过其他术语来定义它。

相反，我们将通过示例来定义它。数字和字符串是值。对象和函数也是值。

也有很多不是值，比如我们代码中的一部分 -- `if` 语句、循环和变量声明。

## 值和代码

在我们开始构建我们的心智模型前，我们需要清除的第一个常见误解是值是我们的代码。相反，我们需要单独考虑它们 -- 我们的代码与值交互，但是值存在于一个完全独立的空间。

为了区分我们的 JavaScript 程序中的值和代码，我喜欢想象 Antoine de Saint-Exupéry 的这幅小王子图画：

![little_prince](/little_prince.jpg)

我正站在一个小型星球，手里拿着一份指令清单。这份清单是我的程序 -- 我的代码。当我阅读我的指令清单时，我能看见很多事情 -- 有 `if` 语句、变量声明、逗号和大括号。

我的代码包含诸如“调用一个函数”、“重复做某件事”或者“抛出一个错误”。我从我的小世界的表面逐步阅读了这些说明。

但是每隔一段时间我都会抬头看。

在一个晴朗的夜晚，我在 JavaScript 天空中看到了不同的值：booleans、numbers、strings、symbols、functions 和 objects，`null` 和 `undefined` -- 天呐！我可能在我的代码中引用它们，但是它们并不存在于我的代码中。

在我们的 JavaScript 宇宙中，值浮动在空中。

![universe.png](/universe.png)

“等等”，你也许会说，“我一直认为值在我的代码中！”。在这里，我请求你进行一个大胆的尝试。这个心智模型还有几个模块才能得到回报。[给它五分钟](https://signalvnoise.com/posts/3124-give-it-five-minutes)。我知道我在做什么。

## 值

从广义上讲，有两种值。

### 原始值

**原始值**像星星 -- 寒冷且遥远，但是我需要的时候它们总是在那里。即使在我的小星球表面我也能发现并指出它们。它们可以是数字、字符串或者其他。所有的原始值都有一个共同点：**它们是我们 JavaScript 宇宙的永久组成部分。我可以指出它们，但是我不能创建、销毁或者更改它们**。

要在实践中查看原始值，请打开你的浏览器的控制面板并打印它们：

```js
console.log(2);
console.log("hello");
console.log(undefined);
```

### 对象和函数

**对象和函数**也是值，但是跟原始值不一样，**我可以从我的代码中操作它们**。如果原始值像遥远的星星，那么对象和函数更像是漂浮我的星球上的小行星。它们不是我代码中一部分，但是它们近得可以进行操作。

:::warning{title=趣闻}

函数是对象，但是由于它们包含一些独特的附加功能，因此我们将单独引用它们以避免混淆。

:::

继续将其中一部分打印到浏览器控制面板：

```js
console.log({});
console.log([]);
console.log(x => x * 2);
```

注意浏览器控制面板显示它们跟原始值是不同的。某些浏览器也许会在它们面前显示一个箭头，或者当你点击它们时做一些特别的事情。如果你安装了几种不同的浏览器，比较它们是如何可视化对象和函数的。

### 值的类型

一开始，JavaScript 宇宙中所有值看起来可能都一样 -- 仅仅是天空的亮点。但是，我们在这里就是为了研究漂浮在我们 JavaScript 宇宙上空所有不同的事物，因此我们需要一个方法来对它们进行分类。

我们可以将值拆分为类型 -- 相同类型的值具有类似的行为。作为一名有抱负的天文学家，你可能想要了解所有能在 JavaScript 天空中能够观察到的每种值的类型。

经过近 25 年的研究，科学家们只发现了 9 种这样的类型。

## 原始值

- **Undefined(`undefined`)**，用于无意中缺失的值；
- **Null(`null`)**，用于有意缺失的值；
- **Booleans(`true` 和 `false`)**，用于逻辑运算；
- **Numbers(`-100`,`3.14` 和其他)**，用于数学计算；
- **BigInts(不普通且新)**，用于大数的数学计算；
- **Strings (`"hello"`,`"abracadabra"` 和其他)**，用于文本；
- **Symbols (不普通)**，用于执行仪式和隐藏秘密；

## 对象和函数

- **Objects(`{}` 和其他)**，用于组合相关的数据和代码；
- **Functions(`x => x * 2` 和其他)**，用于引用代码；

## 无其他类型

你可能会问题：“但是我使用过的其他类型呢？比如数组？”。

**在 JavaScript 中，除了我们刚刚列举的那些之外，没有其他类型**。剩下的都是对象！例如，数组、日期和正则表达式在 JavaScript 中基本上都是对象：

```js
console.log(typeof([])); // "object"
console.log(typeof(new Date())); // "object"
console.log(typeof(/(hello|goodbye)/)); // "object"
```

:::warning{title=趣闻}

“我明白了”，你可能会回答，“这是因为一切都是对象！”。哎，这是一个[流行的都市传说](https://www.google.com/search?q=%22in%20javascript%20everything%20is%20an%20object%22)，但这不是真的。

尽管像 `"hi".toUpperCase()` 使 `"hi"` 像一个对象，但这只是一个错觉。JavaScript 会在你这样做的时候创建一个临时对象，然后立即销毁它。如果你还不完全理解这个机制也没关系。这确实令人困惑！

:::

## 类型检测

只有 9 种值的类型，但是我们如何知道一个特定值的类型？

![telescope.png](/telescope.png)

如果我们想要检查一个值的类型，我们可以使用 `typeof` 操作符。以下是一些你可以在浏览器控制面板尝试的示例：

```js
console.log(typeof 2); // "number"
console.log(typeof "hello"); // "string"
console.log(typeof undefined); // "undefined"
```

严格来说，`typeof` 的括号不是必须的。例如，`typeof 2` 和 `typeof(2)` 是等价的。然而，为了避免歧义有时候括号是必须的。下面的示例中就有一个会因为我们省略 `typeof` 后的括号而中断。尝试猜测是哪一个：

```js
console.log(typeof({})); // "object"
console.log(typeof([])); // "object"
console.log(typeof(x => x * 2)); // "function"
```

你可以在浏览器的控制面板验证你的猜测。

<video src="/using-typeof.webm" autoPlay loop muted controls />

你可能有问题。很好。如果你提出问题，我们的 JavaScript 宇宙可能会回答！当然，前提是你知道如何提问。

## 表达式

有很多问题时 JavaScript 无法回答的。如果你想知道是向你最好的朋友坦白你的真实情感还是等到你们都变成了白骨哪个更好时，JavaScript 可能有太大帮助。

但是 JavaScript 很乐意回答一些问题。这些问题有一个特殊的名 -- 它们被称为表达式。

如果我们“询问” `2 + 2` 这个表达式，JavaScript 会“回答”值是 `4`。

```js
console.log(2 + 2); // 4
```

再举一个例子，记住我们是如何使用 `typeof` 确定一个值的类型的。实际上，那也是一个表达式。我们的“问题”是 `typeof 2`，JavaScript 宇宙会以一个字符串值 `"number"` 回答我们。

```js
console.log(typeof(2)); // "number"
```

**表达式是 JavaScript 可以回答的问题**。JavaScript 唯一知道的回到表达式的方式是 -- 值。

<video src="/Expression.webm" autoPlay loop muted controls />

如果“表达式”这个单词让你感到困惑，可以将其视为_表示_一个值的一段代码。你可能听别人说  `2 + 2` “结果”或者“计算”为 `4`。这些都是表达同一事物的不同方式。

我们询问 JavaScript `2 + 2`，它回答 `4`。**表达式总是以一个单独的值作为结果**。现在我们对表达式的了解足以玩出花样了。

## 回顾

让我们回顾下我们目前为止学到的东西：

1. **有值，然后有代码**。我们可以将值想象为“漂浮”在我们的 JavaScript 宇宙中的不同的东西。他们不存在于我们的代码中，但是我们可以通过代码指向它们；
2. **有两种不同类型的值：原始值，对象和函数**。总共有 9 中不同的类型。每种类型都有特定的用途，但是有的类型很少用到；
3. **有的值是单独的**。例如，`null` 是 Null 类型唯一的值，`undefined` 是 Undefined 类型唯一的值。后面我们会知道这两种独立的值是真正的麻烦制造者！
4. **我们可以使用表达式询问问题**。表达式存在于我们的代码，所以它们不是值。相反，JavaScript 会用值来回答我们的表达式。例如，`2 + 2` 是一个表达式，JavaScript 会用值 `4` 来回答。
5. **我们可以使用 `typeof` 表达式来确定一个值的类型**。例如，`typeof(4)` 会使用字符串 `"number"` 来作为结果。
