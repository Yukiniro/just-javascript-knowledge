# 心智模型

阅读下面代码：

```js
let a = 10;
let b = a;
a = 0;
```

代码运行后，a 和 b 的值分别是多少？在继续阅读之前，先在脑海中计算一下。

如果已经写了一段时间的 JavaScript，你可能会反对：“这段代码比我每天写的代码简单多了。有什么意义？”

这个练习的目的不是给你介绍变量。我们假设你已经熟悉变量。相反，它是为了让你注意到并反思你的心智模型。

## 什么是心智模型

再次有目的地阅读上面的代码，并下定决心确定结果。（我们稍后会看到为什么这个决心很重要。）

当你再次阅读这段代码时，注意你的脑海中发生了什么。你可能会注意到一个独白，像这样：

- `let a = 10`;
  - 创建一个变量 `a`，并将其设置为 `10`。
- `let b = a`;
  - 创建一个变量 `b`，并将其设置为 `a`。
  - 等等，`a` 又是啥？嗷，`a` 是 10。所以 `b` 也是 10。
- `a = 0`;
  - 将 `a` 的值改为 `0`。
- 所以，`a` 现在是 `0`，`b` 是 `10`。这就是我们的答案。

也许你的内心独白会有点不一样。也许你会说 “分配” 而不是 “设置”，或者也许你阅读的顺序有一点不同。也许你会得到一个不同的结果。注意这些到底有什么不同。注意即使是这个独白也无法捕获你脑海中真正发生的事情。你也许会说 “设置 `b` 为 `a`”，但是设置一个变量究竟意味着什么？

你可能会发现，对于每个熟悉的基础编程概念（比如变量）及其操作（比如设置变量的值）都会有一组根深蒂固的与之相关的类比。有的来自于真实世界，有的来自于你第一次学习的其他领域的重新利用，比如数学中的数字。这些类比可能重叠甚至自相矛盾，但是它们仍然能够帮助你理解代码中发生的事情。

例如，许多人第一次学习变量时会将其理解为“盒子” -- 存放东西的容器。即使当你看到一个变量时不再主动想象为盒子，它们仍然会在你的想象中表现为“盒子状”。

这种你脑海中事情如何运作的方式就被称为“心智模型”。如果你已经编程了很长时间，这可能会比较困难，但是请尝试注意和反思你的心智模型。它们可能是视觉、空间和机器心理捷径的混合。这些直觉（比如变量的“盒子性”）影响我们一生阅读代码的方式。

不幸的是，我们的心智模型有时候是错误的。也许我们早期阅读的教程为了更容易解释概念牺牲了准确性。也许，当我们学习 JavaScript 时，我们错误地“搬运了”早期学习的其他语言的预期行为。也许我们从一些代码的片段中推导出了一个心智模型，但是从来没有验证它的准确性。

识别和修复这些问题就是 _Just JavaScript_ 的全部内容。我们将从头建立（或者重新建立）准确且有用的 JavaScript 心智模型。良好的心智模型将让你对自己的代码充满自信，这也会让你理解（并修复）其他人写的代码。

（顺便说一句，`a` 是 `0`，`b` 是 `10` 是正确答案）。

## 编程，快和慢

《思考，快和慢》是 Daniel Kahneman 编写的一本关于人类思维的书。书中将人类思维分为两个系统。

只要有可能，我们都会依赖于“快”系统，它擅长模式匹配和“本能反应”。我们跟许多动物共享这个系统（这是生存所必需的！），这个系统赋予我们惊人的力量，例如行走且不会摔倒的能力。但是这个系统不擅长计划。

独特的是，由于前额叶的发展，人类还拥有“慢”的思考系统。这个“慢”系统负责复杂的逐步推理。它让我们计划未来的事件，参与争论或者遵循数学证明。

因为使用“慢”系统非常消耗精力，所以我们倾向于默认使用“快”系统 -- 即使是处理诸如编程这样的智力任务。

想象一下，你这样在处理大量工作，并且你想要快速识别这个方法的意图。看一下：

```js
function duplicateSpreadsheet(original) {
  if (original.hasPendingChanges) {
    throw new Error('You need to save the file before you can duplicate it.');
  }
  let copy = {
    created: Date.now(),
    author: original.author,
    cells: original.cells,
    metadata: original.metadata,
  };
  copy.metadata.title = 'Copy of ' + original.metadata.title;
  return copy;
}
```

你可能已经注意到：

- 这个方法复制了一个表格；
- 如果原始表格有未保存的更改，方法会抛出一个错误；
- 它将 “Copy of ” 添加到新表格的标题中；

你可能没有注意到（如果注意到就太好了）这个方法还会意外地改变原始表格的标题。像这样的 bug 是每个程序员每天都会发生的事情。

现在你知道有一个 bug 存在，你将会不同的方式阅读这段代码吗？如果你首先使用“快”思考系统，你也许会在注意到代码中的 bug 后切换到更加费力的“慢”思考系统。

当我们使用“快”系统时，我们会根据代码的整体结构、命名约定和注释来推断代码的意图。当使用“慢”系统时，我们会逐步回溯代码的作用 -- 这是一个累人且费时的过程。

这就是为什么拥有一个准确的心智模型如此重要的原因。在你的脑海中模拟计算机是很困难的，当你不得不回退到“慢”系统时，你的心智模型是你唯一能依赖的。在错误的心智模型下，你将从根本上误解对代码的期望，并且你的努力都将白费。

如果你完全找不到这个 bug 也不用担心 -- 这仅仅意味着你能够充分利用这个课程。在接下来的模块中，我们将一起重建关于 JavaScript 的心智模型，以便你可以立刻不过此类的 bug。

在下一个模块中，我们将开始为一些最基本的 JavaScript 概念（值和变量）构建心智模型。
